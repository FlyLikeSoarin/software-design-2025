# Что делает каждый компонент (кратко)

- API Gateway - единая точка входа, маршрутизация, JWT-проверка, лимиты.
- Auth Service - аутентификация, роли: диспетчер, бригадир, ремонтник, ОТК, бухгалтерия, админ. Интеграция с IdP/SSO.
- Defect Service - регистрация дефекта, стадия, место на схеме, причина, связь с авто.
- Repair Service - назначение технику, фиксация начала/конца, место ремонта, результат.
- Zone Service - справочник участков, ремонтных зон и мест, их занятость.
- Crew Service - бригады, бригадир, отметка доступности сотрудников на смену.
- QC Service - учёт стендовых и ходовых испытаний, pass/fail.
- Dispatch Service - логика направления авто в свободную зону с учётом свободных мест и доступных работников; может работать синхронно через API и асинхронно через BUS.
- Reporting Service - формирует: свод для ОТК, отчёт начальнику цеха, отчёты бригад, месячную посещаемость; пишет агрегаты в OLAP/мат. представления.
- Notification Service - отправка писем/чат-уведомлений (конец смены).
- DB (PostgreSQL) - транзакционные данные: авто, дефекты, ремонты, зоны, бригады, доступность, пользователи.
- BUS (Kafka/RabbitMQ) - события: DefectCreated, RepairStarted/Finished, QCResultRecorded - для отчётов и реактивной диспетчеризации.
- Redis (CACHE) - кэш состояния свободных мест, быстрые очереди задач диспетчера.
- Object Storage - вложения: фото дефекта, сканы актов.
- ERP/MES - план производства, заказы/конфигурации; PLC - события конвейера (ID авто вошёл/вышел из участка).
- Email/SMTP - отправка отчётов.

# Как это поддерживает ключевые сценарии

1. Регистрация дефекта UI → Gateway → Defect Service → DB; событие в BUS → Reporting, Dispatch.
2. Назначение и ремонт UI бригадира → Repair Service → проверка свободного места через Zone Service и кэш → запись start/end → событие в BUS.
3. Диспетчеризация Dispatch Service подписан на DefectCreated, читает свободные места из Zone Service и доступность из Crew Service, кладёт рекомендации/задачи в Redis, шлёт уведомление исполнителю.
4. Сменные отчёты Reporting Service подписан на события ремонта/ОТК, агрегирует в OLAP/мат. представления, по cron в конце смены шлёт отчёты через Notification Service.
